---
layout: single
title: 点估计的两种策略
date: 2024-12-31
author: listenzcc
categories: binomial distribution
toc: true
---

本文是对前面几篇短文的小结，小结了“德国坦克问题”的两种估计方法。
本文讨论了通过小量观测样本估计总体数量的两种方法：频率方法和贝叶斯方法。
频率方法基于样本的最大值进行估计，随着样本数量增加，估计值趋于真实值。
贝叶斯方法利用后验概率和贝叶斯公式进行估计，尽管估计值偏高，但在样本数量足够大时也趋于真实值。

## 问题描述

这是通过小量观测样本，估计总体数量的问题，描述如下

1. 某一个有限集，每个元素按自然数编号，编号为 $1, 2, \dots T$，$T$ 代表集合的规模。
2. $T$ 未知。
3. 从集合中均匀、无放回地抽样 $k$ 次。
4. 采集到的样本按标号从小到大排列，它们的标号计为 $x_1, x_2, \dots x_k$。

问题是如何从采集到的样本中估计 $\hat{T}$ 值。
用统计学的语言可以表示为观测到 $k$ 个随机变量

$$
X_1, X_2, …, X_k \in X
$$

通过它们构造统计量 $f(X)$，并通过计算 $g(f(X))$ 得到 $T$ 的估计。其中， $f$ 和 $g$ 代表某种代数方法。
那么问题就转换成了如何找到合适的代数方法。

## 统计量的构造

构造统计量的方法是计算样本中的最大值

$$
f(X) = \max(X)
$$

为了更明确地表达它的意义，将最大值计为 $M$，它是一个随机变量。

$$
M = \max(X)
$$

对于某一组样本来说，$m \in M$ 是对该随机变量的一次采样。
下面开始考虑 $\hat{T} = g(M)$，即通过该统计量得到样本规模随机变量 $T$ 的点估计。

进行点估计的方法有频率方法和贝叶斯方法两种，两种方法的证明已经在前几篇短文中提及，这里对结果进行小结。

## 估计方法：频率方法

频率方法给出了这样的估计，它的原理是在采样规模为k的前提下，得到了统计量的一次观测值m。由于只观测了一次，因此有理由推测 $M$ 的均值 $E(M)=m$。首先考虑统计量 $M=m$ 的概率密度函数，

$$
Pr(M=m)=\frac{C_{m-1}^{k-1}}{C_t^k}
$$

接下来得到 $E(M)$ 与 $t$ 值的关系式

$$
E(M)=\frac{k}{k+1} (t+1)
$$

最终可以得到

$$\tag{1}
\hat{t} = m \frac{k+1}{k} - 1
$$

当观测样本的数量足够多时，其极限状态为 $t=m=k$，此时上式变为

$$
t=t \frac{t+1}{t} - 1
$$

这是很神奇的规律，它表明随着采样规模的增加，频率估计方法收敛于真实值。

## 估计方法：贝叶斯方法

贝叶斯方法给出了这样的估计，它的原理是在采样规模为 $k$，并且得到了统计量的一次观测值 $m$ 的条件下，基于后验概率和贝叶斯公式计算 $T$ 的估计值。
首先考虑 $M=m$ 的概率密度函数

$$
Pr(M=m|t, k)=\frac{C_{m-1}^{k-1}}{C_t^k}
$$

之后利用贝叶斯公式

$$
P(M|T)P(T)=P(T|M)P(M)
$$

这里用到一个重要的假设，即统计量 $M$ 的分布服从均匀分布，且要求均匀分布的参数 $\mu$ 足够大（远大于可能的 $m$ 值）。

$$
P(M)=\frac{1}{\mu-k}, \mu \gg M
$$

经计算可以得到 $T$ 的概率密度函数

$$\tag{2}
Pr(T=t|m, k)=\frac{C_{m-1}^{k-1}}{C_t^k} \cdot \frac{k-1}{k}
$$

概率密度函数可以做很多事情，首先可以求出 $T$ 的均值

$$\tag{3}
E(t) = \frac{(m-1)(k-1)}{k-2}
$$

不难发现，当观测样本的数量足够多时，其极限状态为 $t=m=k$，此时上式变为

$$
E(T)=\frac{t^2-2t+1}{t-2}=t+\frac{1}{t-2}
$$

这表明贝叶斯方法得到的估计值偏大，但当 $t$ 越大时，估计值偏离程度越小。在极限情况下也趋于收敛到理想值

$$
\lim_{t \to \infty} E(T)=t
$$

贝叶斯方法还可以得到T的方差

$$
Var(T) = \frac{(k-1)(m-1)(m-k+1)}{(k-3)(k-2)^2}
$$

可见，当 $k$ 增加时， $Var$ 按倒数的规律下降。

## 估计结果分析

为了对估计结果进行定性分析，我进行了随机采样实验。下图中蓝色点代表不同 $k$ 值时对应的 $M, T$ 值分布。红色和绿色线代表频率方法和贝叶斯方法的估计值。
两图分别给出了 $k=4, 14$ 时的估计结果，从结果中可以看到使用上述估计方法，只需要随机观测 $10 - 20$ 个样本即可以得到比较准确的估计值，说明了估计方法的有效性

![small k result](/assets/binomial-distribution-img/german-tank-problem-small-k-result.png "small k result")

![large k result](/assets/binomial-distribution-img/german-tank-problem-large-k-result.png "large k result")

两种估计方法的共性是当极限条件下，估计值都趋向于 $T$，但不同点在于贝叶斯估计给出的估计值偏高。
究其原因，我想应该考虑 $(2)$ 式，将它扩写如下

$$\tag{2a}
Pr(T=t|m, k) = Pr(T=t|M=m, k)
$$

其意义代表观测到 $m\in M$ 时 $T$ 取值的概率密度。后续分析也是将它当作 $T$ 的概率密度函数。这样做有什么问题？
我认为它仅立足于观测样本，而没有考虑 $m\in M$ 本身的概率密度。由于 $M$ 是统计量，统计量本身也是随机变量，应有

$$
Pr(T) = Pr(T | M) Pr(M)
$$

私以为由于是条件概率，因此假定 $P(M=m)=1$，这一点造成了 $P(M)$ 的估计值偏大。
从模拟结果可以看到，$M$ 值具有一定的分布，而观测到任意 $m$ 值的概率均不为零。
这导致 $P(T | M)$ 偏大，最终导致贝叶斯估计的均值偏大。

回到频率的估计方法，这里不对 $T$ 的分布做任何假设，只是在 $k$ 的条件下建立 $T, E(M)$ 的关系。
那么问题的关键就落到了如何估计 $E(M)$ 上。
这个估计的准确性越高，那么对 $T$ 进行点估计的准确性也相应越高。
似乎也有证明说 $E(M) = m$ 的估计是最小方差的无偏估计，因此可以说频率方法的准确性是有保障的。
